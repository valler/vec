import { assertEquals, test } from "./dev.ts";
import { dot, dots, vecsToDots } from "./dot2.ts";
import { lerpFromTo, one, zero } from "./vec2.ts";

test("dot", () => {
  assertEquals(
    dot(1, 2, .5, 1, 0, 1, .5),
    {
      attribs: [
        { name: "pos", dim: 2 },
        { name: "size", dim: 1 },
        { name: "col", dim: 4 },
      ],
      stride: 7,
      indices: [0, 1, 2, 2, 1, 3],
      // deno-fmt-ignore
      vertices: [
        1, 2, .5, 1, 0, 1, .5,
        1, 2, .5, 1, 0, 1, .5,
        1, 2, .5, 1, 0, 1, .5,
        1, 2, .5, 1, 0, 1, .5,
      ],
    },
  );
});

test("dots", () => {
  assertEquals(
    dots(
      dot(0, 0, .5, 1, 0, 1, .1),
      dot(0, 1, .5, 1, 0, 1, .2),
      dot(1, 0, .5, 1, 0, 1, .3),
      dot(1, 1, .5, 1, 0, 1, .4),
    ),
    {
      attribs: [
        { name: "pos", dim: 2 },
        { name: "size", dim: 1 },
        { name: "col", dim: 4 },
      ],
      stride: 7,
      // deno-fmt-ignore
      indices: [
        0, 1, 2, 2, 1, 3,
        4, 5, 6, 6, 5, 7,
        8, 9, 10, 10, 9, 11,
        12, 13, 14, 14, 13, 15,
      ],
      // deno-fmt-ignore
      vertices: [
        0, 0, .5, 1, 0, 1, .1,
        0, 0, .5, 1, 0, 1, .1,
        0, 0, .5, 1, 0, 1, .1,
        0, 0, .5, 1, 0, 1, .1,
        0, 1, .5, 1, 0, 1, .2,
        0, 1, .5, 1, 0, 1, .2,
        0, 1, .5, 1, 0, 1, .2,
        0, 1, .5, 1, 0, 1, .2,
        1, 0, .5, 1, 0, 1, .3,
        1, 0, .5, 1, 0, 1, .3,
        1, 0, .5, 1, 0, 1, .3,
        1, 0, .5, 1, 0, 1, .3,
        1, 1, .5, 1, 0, 1, .4,
        1, 1, .5, 1, 0, 1, .4,
        1, 1, .5, 1, 0, 1, .4,
        1, 1, .5, 1, 0, 1, .4,
      ],
    },
  );
});

test("vecsToDots", () => {
  assertEquals(
    vecsToDots(lerpFromTo(zero, one, 4), .1, 1, 1, 1, 1),
    {
      attribs: [
        { name: "pos", dim: 2 },
        { name: "size", dim: 1 },
        { name: "col", dim: 4 },
      ],
      stride: 7,
      // deno-fmt-ignore
      indices: [
        0, 1, 2, 2, 1, 3,
        4, 5, 6, 6, 5, 7,
        8, 9, 10, 10, 9, 11,
        12, 13, 14, 14, 13, 15,
        16, 17, 18, 18, 17, 19,
      ],
      // deno-fmt-ignore
      vertices: [
        0, 0, 0.1, 1, 1, 1, 1,
        0, 0, 0.1, 1, 1, 1, 1,
        0, 0, 0.1, 1, 1, 1, 1,
        0, 0, 0.1, 1, 1, 1, 1,
        0.25, 0.25, 0.1, 1, 1, 1, 1,
        0.25, 0.25, 0.1, 1, 1, 1, 1,
        0.25, 0.25, 0.1, 1, 1, 1, 1,
        0.25, 0.25, 0.1, 1, 1, 1, 1,
        0.5, 0.5, 0.1, 1, 1, 1, 1,
        0.5, 0.5, 0.1, 1, 1, 1, 1,
        0.5, 0.5, 0.1, 1, 1, 1, 1,
        0.5, 0.5, 0.1, 1, 1, 1, 1,
        0.75, 0.75, 0.1, 1, 1, 1, 1,
        0.75, 0.75, 0.1, 1, 1, 1, 1,
        0.75, 0.75, 0.1, 1, 1, 1, 1,
        0.75, 0.75, 0.1, 1, 1, 1, 1,
        1, 1, 0.1, 1, 1, 1, 1,
        1, 1, 0.1, 1, 1, 1, 1,
        1, 1, 0.1, 1, 1, 1, 1,
        1, 1, 0.1, 1, 1, 1, 1,
      ],
    },
  );
});
